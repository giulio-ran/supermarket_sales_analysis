<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/><style>
table {border: medium solid #6495ed;border-collapse: collapse;width: 100%;} th{font-family: monospace;border: thin solid #6495ed;padding: 5px;background-color: #D0E3FA;}th{text-align: left;}td{font-family: sans-serif;border: thin solid #6495ed;padding: 5px;text-align: center;}.odd{background:#e8edff;}img{padding:5px; border:solid; border-color: #dddddd #aaaaaa #aaaaaa #dddddd; border-width: 1px 2px 2px 1px; background-color:white;}</style>
</head>
<body>
<table><tr><th colspan="4"><pre><code>/* Discount and profit by sub-category */<br>SELECT <br>    p.sub_category AS 'Category',<br>    s.discount AS 'Discount',<br>    ROUND(AVG(s.profit), 2) AS 'Average profit',<br>    CASE <br>        WHEN AVG(s.profit) &gt; 0 THEN 'Positive'<br>        ELSE 'Negative'<br>    END AS 'Profitability status'<br>FROM sales s<br>JOIN products p ON s.product_id = p.product_id<br>GROUP BY 1,2<br>ORDER BY 3 desc</code></pre></th></tr><tr><th>Category</th><th>Discount</th><th>Average profit</th><th>Profitability status</th></tr><tr class="odd"><td>Copiers</td><td>0</td><td>1.500,89</td><td>Positive</td></tr>
<tr><td>Machines</td><td>0</td><td>942,6</td><td>Positive</td></tr>
<tr class="odd"><td>Machines</td><td>0,1</td><td>574,41</td><td>Positive</td></tr>
<tr><td>Copiers</td><td>0,2</td><td>447,05</td><td>Positive</td></tr>
<tr class="odd"><td>Copiers</td><td>0,4</td><td>230,54</td><td>Positive</td></tr>
<tr><td>Tables</td><td>0</td><td>178,93</td><td>Positive</td></tr>
<tr class="odd"><td>Machines</td><td>0,2</td><td>161,57</td><td>Positive</td></tr>
<tr><td>Chairs</td><td>0</td><td>157,53</td><td>Positive</td></tr>
<tr class="odd"><td>Binders</td><td>0</td><td>115,17</td><td>Positive</td></tr>
<tr><td>Phones</td><td>0</td><td>106,77</td><td>Positive</td></tr>
<tr class="odd"><td>Bookcases</td><td>0</td><td>103,75</td><td>Positive</td></tr>
<tr><td>Chairs</td><td>0,1</td><td>92,24</td><td>Positive</td></tr>
<tr class="odd"><td>Accessories</td><td>0</td><td>84,28</td><td>Positive</td></tr>
<tr><td>Appliances</td><td>0</td><td>80,23</td><td>Positive</td></tr>
<tr class="odd"><td>Machines</td><td>0,3</td><td>78,54</td><td>Positive</td></tr>
<tr><td>Appliances</td><td>0,1</td><td>60,06</td><td>Positive</td></tr>
<tr class="odd"><td>Storage</td><td>0</td><td>51,82</td><td>Positive</td></tr>
<tr><td>Binders</td><td>0,2</td><td>49,6</td><td>Positive</td></tr>
<tr class="odd"><td>Phones</td><td>0,2</td><td>35,7</td><td>Positive</td></tr>
<tr><td>Paper</td><td>0</td><td>31,35</td><td>Positive</td></tr>
<tr class="odd"><td>Envelopes</td><td>0</td><td>29,64</td><td>Positive</td></tr>
<tr><td>Bookcases</td><td>0,15</td><td>28,79</td><td>Positive</td></tr>
<tr class="odd"><td>Furnishings</td><td>0</td><td>28,33</td><td>Positive</td></tr>
<tr><td>Accessories</td><td>0,2</td><td>26,6</td><td>Positive</td></tr>
<tr class="odd"><td>Appliances</td><td>0,2</td><td>22,87</td><td>Positive</td></tr>
<tr><td>Labels</td><td>0</td><td>21,15</td><td>Positive</td></tr>
<tr class="odd"><td>Chairs</td><td>0,2</td><td>19,43</td><td>Positive</td></tr>
<tr><td>Envelopes</td><td>0,2</td><td>19,25</td><td>Positive</td></tr>
<tr class="odd"><td>Paper</td><td>0,2</td><td>18,55</td><td>Positive</td></tr>
<tr><td>Supplies</td><td>0</td><td>12,86</td><td>Positive</td></tr>
<tr class="odd"><td>Art</td><td>0</td><td>11,08</td><td>Positive</td></tr>
<tr><td>Labels</td><td>0,2</td><td>9,7</td><td>Positive</td></tr>
<tr class="odd"><td>Furnishings</td><td>0,2</td><td>8,88</td><td>Positive</td></tr>
<tr><td>Fasteners</td><td>0</td><td>5,82</td><td>Positive</td></tr>
<tr class="odd"><td>Fasteners</td><td>0,2</td><td>3,7</td><td>Positive</td></tr>
<tr><td>Art</td><td>0,2</td><td>3,42</td><td>Positive</td></tr>
<tr class="odd"><td>Tables</td><td>0,2</td><td>2,81</td><td>Positive</td></tr>
<tr><td>Bookcases</td><td>0,2</td><td>1,83</td><td>Positive</td></tr>
<tr class="odd"><td>Storage</td><td>0,2</td><td>-15,12</td><td>Negative</td></tr>
<tr><td>Supplies</td><td>0,2</td><td>-36,38</td><td>Negative</td></tr>
<tr class="odd"><td>Furnishings</td><td>0,6</td><td>-36,97</td><td>Negative</td></tr>
<tr><td>Chairs</td><td>0,3</td><td>-42,25</td><td>Negative</td></tr>
<tr class="odd"><td>Binders</td><td>0,7</td><td>-46,29</td><td>Negative</td></tr>
<tr><td>Bookcases</td><td>0,3</td><td>-48,01</td><td>Negative</td></tr>
<tr class="odd"><td>Tables</td><td>0,3</td><td>-59,57</td><td>Negative</td></tr>
<tr><td>Phones</td><td>0,4</td><td>-60,17</td><td>Negative</td></tr>
<tr class="odd"><td>Bookcases</td><td>0,32</td><td>-81,54</td><td>Negative</td></tr>
<tr><td>Binders</td><td>0,8</td><td>-85,23</td><td>Negative</td></tr>
<tr class="odd"><td>Appliances</td><td>0,8</td><td>-129,07</td><td>Negative</td></tr>
<tr><td>Tables</td><td>0,4</td><td>-203,18</td><td>Negative</td></tr>
<tr class="odd"><td>Tables</td><td>0,45</td><td>-217,62</td><td>Negative</td></tr>
<tr><td>Bookcases</td><td>0,5</td><td>-219,56</td><td>Negative</td></tr>
<tr class="odd"><td>Tables</td><td>0,5</td><td>-229,22</td><td>Negative</td></tr>
<tr><td>Bookcases</td><td>0,7</td><td>-281,41</td><td>Negative</td></tr>
<tr class="odd"><td>Machines</td><td>0,4</td><td>-295,79</td><td>Negative</td></tr>
<tr><td>Machines</td><td>0,5</td><td>-452,32</td><td>Negative</td></tr>
<tr class="odd"><td>Machines</td><td>0,7</td><td>-1.053,25</td><td>Negative</td></tr>
</table></body></html>